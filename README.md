# HT_SOLS_microscope
Python control code for the first 'high throughput single-objective light-sheet' (HT-SOLS) microscope.

## Key features:
A fast, gentle, large field of view, 3D fluorescence microscope using the single-objective light-sheet ([SOLS](https://andrewgyork.github.io/high_na_single_objective_lightsheet/)) architecture, with an [AMS-AGY v2.0 objective](https://andrewgyork.github.io/high_na_single_objective_lightsheet/appendix.html#AMS-AGY_v2.0) (a.k.a Snouty). This microscope includes the any-immersion remote focus ([AIRR](https://amsikking.github.io/any_immersion_remote_refocus_microscopy/)) technology and real time multi-angle [projections](https://doi.org/10.1038/s41592-021-01175-7).
- **Primary objectives**: 40x air, water and oil immersion, with correction collars for air and water (MRD00405, MRD77410, MRH01401).
- **XYZ field of view**: ~300x300x100um.
- **Excitation**: fast lasers at 405, 488, 561 and 640 (nm).
- **Light-sheet**: Gaussian with powell lens, automated adjustment.
- **Emission**: fast filter wheel with ET445/58M, ET525/50M, ET600/50M, ET706/95M and ZET405/488/561/640m filters.
- **Course/fine focus**: automated z stage and fast piezo.
- **XY stage**: fast piezo walking.
- **Scanning/projections**: fast galvos.
- **Autofocus**: hardware based.
- **Incubation**: stage top temperature and CO2 can be used.
- **Control**: basic GUI and open source API in Python.

![social_preview](https://github.com/amsikking/HT_SOLS_microscope/blob/main/social_preview.png)

## Details:
### Emission path:
The sample is held by an automated XY stage ([Physik Instrumente C-867.2U2](https://github.com/amsikking/pi_C_867_2U2)) and the macroscopic Z location of the XY stage is adjusted with a coarse Z drive ([Dual synchronized Thorlabs MLJ motorized vertical translation stages](https://github.com/amsikking/thorlabs_MLJ_Z_stage)). Enabled by the AIRR concept, a primary objective (O1) is chosen from 3 Nikon 40x options with different numerical apertures (NA) and immersions: NA=0.95 air (MRD00405), NA=1.15 water (MRD77410) or NA=1.3 oil (MRH01401). To maintain the correct Z position for each O1 a seperate Z drive ([Thorlabs MCM3000](https://github.com/amsikking/thorlabs_MCM3000) with ZFM2020) is used to automatically adjust the Z of each O1 depending on the choice of immersion (since they have different back focal plane positions). The course Z drive holding the XY stage then used to compensate the O1 Z drive to keep the sample nominally in focus. The O1 objectives are mounted in a high speed focus piezo with an 800um range ([Physik Instrumente E-709.1C1L](https://github.com/amsikking/pi_E_709_1C1L) with P-725.8CDE2) that is then used for all subsequent fine focus adjustments, and is optionally controlled by a hardware autofocus unit ([Prior PureFocus850](https://github.com/amsikking/prior_PureFocus850)) that sits immediately under the focus piezo. A 2 inch mirror (Thorlabs BB2-E02) folds the light path into the plane of the optical table and is followed by the first tube lens (TL1) which has a 200mm focal length (Thorlabs TTL200). The O1 and TL1 pair produce an intermediate image plane (IP1) with 40x magnification for all choices of O1. A unity magnification scanner images IP1 to IP2 in a lens-galvo-lens configuration using 100mm tube lenses (Thorlabs TTL100-A) and a 10mm diameter galvo (GVS211/M). IP2 is then imaged by the second tube lens (TL2) which in this case consists of the [AIRR zoom lens](https://amsikking.github.io/any_immersion_remote_refocus_microscopy/appendix.html#zoom_lens), with a variable focal length in the range 132.5-150mm. TL2 is followed by a dichroic (Chroma ZT405/488/561/640rpc) to couple in the light-sheet and then the secondary objective (O2) which then forms the remote 3D image. O2 is a Nikon 40x NA=0.95 air objective (MRD70470) with a small diameter 170um AR coated coverslip glued to the front (part and service offered by Applied Scientific Instrumentation, SER-GLUE-AR-N40X). The O2 and TL2 pair produce a magnification in the range of 26.5-30x depending on the zoom lens setting, which together with the O1 and TL2 pair gives a remote 3D image magnification in the range of 1.33-1.51x (the intermediate scanner is 1x). The remote 3D image is then collected by a tertiary objective (O3) which is a 'Snouty' lens with a 9mm focal length ([AMS-AGY v2](https://andrewgyork.github.io/high_na_single_objective_lightsheet/appendix.html#AMS-AGY_v2.0)) and is tilted away from the optical axis of O2 by 55 degrees. A filter wheel ([Sutter Lambda 10-3](https://github.com/amsikking/sutter_Lambda_10_3)) follows O3 to allow different emission filter options (ET445/58M, ET525/50M, ET600/50M, ET706/95M or ZET405/488/561/640m). The tertiary tube lens (TL3) has an effective focal length of 250mm from a custom assembly using a pair of 500mm achromats (Thorlabs ACT508-500-A). The O3 and TL3 pair produce a magnification of ~27.8x and relay the image to the camera ([PCO.edge 4.2 CamLink sCMOS](https://github.com/amsikking/pco_edge42_cl)). A pair of 20mm galvos (Thorlabs QS20X-AG) sit between TL3 and the camera to perform the optical shearing that is needed for the optional real time multi-angle projection imaging mode.

### Excitation path:
A broadband LED (Thorlabs MBB1L3) sits above O1 and can be used for searching samples with transmitted light. The light-sheet excitation has 4 wavelengths (405nm, 488nm, 561nm and 640nm) from a laser box ([Coherent OBIS LS/LX](https://github.com/amsikking/coherent_OBIS_LSLX_laser_box), 1343229) coupled to a beam combiner (Coherent OBIS Galaxy, 1363484) which outputs all 4 laser lines from an FC/APC single-mode polarization-maintaining fiber (NA 0.055). The fiber output is collimated to ~1.2mm (Thorlabs PAF2-A7A) and levelled to the optical table with a 1 inch mirror (Thorlabs PF10-03-P01). The collimated ~1.2mm beam is then adjusted with a variable beam expander (Thorlabs BE052-A) to ~0.8mm, and steered by a pair of 1 inch mirrors (Thorlabs BB1-E02) onto a powell Lens with 30 degree fan angle (Thorlabs LGL130). The fanned light is then collimated by a cylindrical lens with a 24.88mm focal length (Thorlabs LJ1075L1-A). An adjustable slit (Thorlabs VA100CP/M) is placed just before the achromatic cylindrical lens (Thorlabs ACY254-050-A) that generates the light-sheet to modulate the light-sheet thickness. A pair of 1 inch mirrors (Thorlabs BB1-E02 and PF10-03-P01) steer the light-sheet towards the first of three 4f excitation relays (a VA100CP/M could be added between the mirror pair to modulate the light-sheet width in this location). The first relay is for small automated adjustments to light-sheet tilt and position, and consists of a pair of 100mm achromats (Thorlabs AC254-100-A-ML) bracketing a pair of galvos (Thorlabs GVS202) for tilt, followed immediately by another pair of galvos (Thorlabs GVS202) for position. The second relay is for large manual adjustments to light-sheet tilt and position, and consists of a pair of 100mm achromats (Thorlabs AC254-100-A-ML) bracketing a gimbal mirror (Thorlabs GM100/M and BB1-E02) for tilt, followed immediately by another gimbal mirror (Thorlabs GM100/M and BB1-E02) for position. The third and final relay is to couple the light-sheet onto the emission path, and consists of a 100mm achromat (Thorlabs AC254-100-A-ML) and the AIRR zoom lens which bracket the dichroic (Chroma ZT405/488/561/640rpc). The AIRR zoom lens and dichroic are shared with the emission path.
